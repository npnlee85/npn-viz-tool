/*
 * Regs-Dot-Gov-Directives
 * Version: 0.1.0 - 2015-02-17
 */
angular.module("npn-viz-tool.filters",[]).filter("trim",function(){return function(a){return angular.isString(a)?a.trim():a}}).filter("faFileIcon",function(){var a={pdf:"fa-file-pdf-o"};return function(b){return b&&!a[b]&&console.debug("no explicit file type icon for "+b),a[b]||"fa-file-o"}}).filter("ellipses",function(){return function(a){var b=2==arguments.length?arguments[1]:55;return"string"==typeof a&&a.length>b?a.substring(0,b)+" ...":a}}),angular.module("npn-viz-tool",["templates-npnvis","npn-viz-tool.services","npn-viz-tool.map","npn-viz-tool.filters","uiGmapgoogle-maps","ui.bootstrap","ngAnimate"]).config(function(a){a.configure({v:"3.17",libraries:"geometry"})}),angular.module("npn-viz-tool.map",[]).directive("npnVizMap",["uiGmapGoogleMapApi","uiGmapIsReady",function(a){return{restrict:"E",templateUrl:"js/map/map.html",scope:{},controller:["$scope",function(b){a.then(function(a){console.log("maps",a),b.map={center:{latitude:38.8402805,longitude:-97.61142369999999},zoom:4,options:{streetViewControl:!1,panControl:!1,zoomControl:!0,zoomControlOptions:{style:a.ZoomControlStyle.SMALL,position:a.ControlPosition.RIGHT_TOP}}}})}]}}]).directive("npnVizLayers",["uiGmapIsReady","$http",function(a,b){return{restrict:"E",template:"",scope:{},controller:["$scope",function(c){a.promise(1).then(function(a){function d(){if(c.featureMap&&c.countMap){console.log("$countMap",c.countMap);var a=d3.scale.linear().domain([c.countMap.$min,c.countMap.$max]).range(["#F7FBFF","#08306B"]);e.data.setStyle(function(b){var d=b.getProperty("NAME"),e=c.countMap[d],f={strokeOpacity:1,strokeColor:"#ffffff",strokeWeight:1,fillOpacity:0};return e?(f.fillOpacity=.8,f.fillColor=a(e.number_stations)):console.warn("no count for "+d),f})}}var e=a[0].map;b.get("layers/us-states.geojson").success(function(a){console.debug(a),e.data.addGeoJson(a);var b={};e.data.setStyle(function(a){b[a.getProperty("NAME")]=a,console.log(a.getProperty("NAME"),a);var c={strokeOpacity:0,fillOpacity:0};return c}),c.featureMap=b}),b.get("/npn_portal/stations/getStationCountByState.json").success(function(a){var b={$max:0};a.forEach(function(a){a.number_stations=parseInt(a.number_stations),(void 0===b.$min||a.number_stations<b.$min)&&(b.$min=a.number_stations),a.number_stations>b.$max&&(b.$max=a.number_stations),b[a.state]=a}),c.countMap=b}),c.$watch("countMap",d),c.$watch("featureMap",d)})}]}}]),angular.module("templates-npnvis",["js/map/map.html"]),angular.module("js/map/map.html",[]).run(["$templateCache",function(a){a.put("js/map/map.html","<ui-gmap-google-map ng-if=\"map\" center='map.center' zoom='map.zoom' options=\"map.options\">\n\n</ui-gmap-google-map>\n\n<npn-viz-layers></npn-viz-layers>")}]),angular.module("npn-viz-tool.services",["ngResource"]);